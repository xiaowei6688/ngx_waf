(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{415:function(a,t,s){"use strict";s.r(t);var e=s(44),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"高级规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高级规则"}},[a._v("#")]),a._v(" 高级规则")]),a._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),s("p",[a._v("高级规则是一种将条件表达式和动作组合起来的规则，只有满足指定的条件时才会执行对应的动作。高级规则更加灵活，但是也更加消耗性能。")]),a._v(" "),s("h2",{attrs:{id:"状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#状态"}},[a._v("#")]),a._v(" 状态")]),a._v(" "),s("p",[a._v("此功能处在纸面设计阶段，期待您的建议。")]),a._v(" "),s("h2",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[a._v("#")]),a._v(" 示例")]),a._v(" "),s("p",[a._v("下面的例子表示如果 "),s("code",[a._v("url")]),a._v(" 中包含 "),s("code",[a._v("/install")]),a._v(" 则返回 HTTP 403 状态码。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("id: 'example'\nif: url contains '/install'\ndo: return\nstatus: 403\n")])])]),s("hr"),a._v(" "),s("p",[a._v("下面的例子表示如果 "),s("code",[a._v("user-agent")]),a._v(" 中不包含 "),s("code",[a._v("secret")]),a._v(" 则返回 HTTP 403 状态码。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("id: 'example'\nif: user-agent not equals 'secret'\ndo: return \nstatus: 403\n")])])]),s("hr"),a._v(" "),s("p",[a._v("下面的例子表示如果 "),s("code",[a._v("url")]),a._v(" 能够正则表达式 "),s("code",[a._v("^/admin")]),a._v(" 所匹配，或者 "),s("code",[a._v("user-agent")]),a._v(" 等于 "),s("code",[a._v("secret")]),a._v(" 则停止后续的所有检测并直接放行本次请求。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("id: 'example'\nif: url matches '^/admin' || user-agent equals 'secret'\ndo: allow\n")])])]),s("h2",{attrs:{id:"语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[a._v("#")]),a._v(" 语法")]),a._v(" "),s("h3",{attrs:{id:"一般格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一般格式"}},[a._v("#")]),a._v(" 一般格式")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("id: 'value'\nif: condition\ndo: action\naction_paramter: value\n\nid: 'value'\nif: condition\ndo: action\naction_paramter: value\n")])])]),s("p",[a._v("多条规则之间至少用一个空行分隔。")]),a._v(" "),s("ul",[s("li",[a._v("id：规则的标识符，触发时会被写入日志。每条规则只能有一个 ID，一个 ID 可以被多个规则所拥有。")])]),a._v(" "),s("h3",{attrs:{id:"condition"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#condition"}},[a._v("#")]),a._v(" Condition")]),a._v(" "),s("p",[a._v("下面是 condition 的一般格式。")]),a._v(" "),s("div",{staticClass:"language-bison extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bison"}},[s("code",[a._v("condition   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v("    field comparison_operator "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'value'")]),a._v("\ncondition   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v("    field logical_operator comparison_operator "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'value'")]),a._v("\ncondition   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v("    condition "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" condition\ncondition   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v("    condition "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("||")]),a._v(" condition\ncondition   "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("condition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("ul",[s("li",[a._v("field：目前仅包含下列取值。\n"),s("ul",[s("li",[a._v("url：请求路径，不含查询字符串。")]),a._v(" "),s("li",[a._v("user-agent: HTTP.Header.User-Agent。")])])]),a._v(" "),s("li",[a._v("comparison_operator：目前仅包含下列取值。\n"),s("ul",[s("li",[a._v("equals：等于。")]),a._v(" "),s("li",[a._v("contains：包含。")]),a._v(" "),s("li",[a._v("matches：能够被正则表达式匹配。")])])]),a._v(" "),s("li",[a._v("logical_operator：目前仅包含下列取值。\n"),s("ul",[s("li",[a._v("not：逻辑非。")])])]),a._v(" "),s("li",[a._v("&&：逻辑与。")]),a._v(" "),s("li",[a._v("||：逻辑或。")])]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("注意")]),a._v(" "),s("p",[a._v("涉及字符串操作除非特别说明，否则均大小写敏感。")])]),a._v(" "),s("h3",{attrs:{id:"action"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#action"}},[a._v("#")]),a._v(" Action")]),a._v(" "),s("p",[a._v("下面是 action 的一般格式。")]),a._v(" "),s("div",{staticClass:"language-bison extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bison"}},[s("code",[a._v("action  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("->")]),a._v("  name\n")])])]),s("ul",[s("li",[a._v("name：目前仅包含下列取值。\n"),s("ul",[s("li",[a._v("return：返回指定的 http 状态码。")]),a._v(" "),s("li",[a._v("allow：停止后续的一切检测并放行本次请求。")])])])]),a._v(" "),s("h3",{attrs:{id:"action-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#action-parameters"}},[a._v("#")]),a._v(" Action Parameters")]),a._v(" "),s("p",[a._v("当 action 为 "),s("code",[a._v("return")]),a._v(" 时，您需要指定下列参数。")]),a._v(" "),s("ul",[s("li",[a._v("status：一个整数，表示要返回的 http 状态码。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);